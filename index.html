<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9Cloud ‚Äî Teamwork Dashboard</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0c1222 0%, #1a1f35 100%);
      color: #e2e8f0;
      min-height: 100vh;
    }

    .dashboard { max-width: 1400px; margin: 0 auto; padding: 20px; }

    /* Header */
    .header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 24px; flex-wrap: wrap; gap: 12px;
    }
    .header h1 {
      font-size: 24px; font-weight: 700;
      background: linear-gradient(135deg, #06b6d4, #8b5cf6);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .header-sub { color: #64748b; font-size: 13px; margin-top: 2px; }
    .header-actions { display: flex; gap: 10px; align-items: center; }

    .btn {
      padding: 8px 18px; border-radius: 8px; border: none;
      font-size: 13px; font-weight: 600; cursor: pointer;
      transition: all 0.2s; font-family: inherit;
    }
    .btn-primary {
      background: linear-gradient(135deg, #06b6d4, #8b5cf6);
      color: #fff;
    }
    .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .last-updated { font-size: 11px; color: #475569; }

    /* Stats Row */
    .stats-row {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px; margin-bottom: 24px;
    }
    .stat-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px; padding: 16px; text-align: center;
    }
    .stat-value {
      font-size: 28px; font-weight: 700;
      background: linear-gradient(135deg, #06b6d4, #8b5cf6);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .stat-value.green { background: linear-gradient(135deg, #10b981, #34d399); -webkit-background-clip: text; }
    .stat-value.amber { background: linear-gradient(135deg, #f59e0b, #fbbf24); -webkit-background-clip: text; }
    .stat-value.red { background: linear-gradient(135deg, #ef4444, #f87171); -webkit-background-clip: text; }
    .stat-value.purple { background: linear-gradient(135deg, #8b5cf6, #a78bfa); -webkit-background-clip: text; }
    .stat-label { font-size: 12px; color: #64748b; margin-top: 4px; font-weight: 500; }

    /* Filters */
    .filters {
      display: flex; gap: 12px; flex-wrap: wrap; align-items: flex-end;
      margin-bottom: 24px;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 12px; padding: 16px;
    }
    .filter-group { display: flex; flex-direction: column; gap: 4px; }
    .filter-label {
      font-size: 11px; font-weight: 600; color: #64748b;
      text-transform: uppercase; letter-spacing: 0.5px;
    }
    select, input[type="date"] {
      padding: 8px 12px; border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.12);
      background: #1a1f35;
      color: #e2e8f0; font-family: inherit; font-size: 13px;
      min-width: 180px; cursor: pointer;
    }
    select option { background: #1a1f35; color: #e2e8f0; }
    select:focus, input[type="date"]:focus { outline: none; border-color: #06b6d4; }
    input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(0.7); }
    input[type="date"] { color-scheme: dark; }

    .view-toggle {
      display: flex; background: rgba(255,255,255,0.06);
      border-radius: 8px; overflow: hidden; margin-left: auto;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .view-toggle button {
      padding: 8px 16px; border: none; background: none;
      color: #64748b; font-family: inherit; font-size: 12px;
      font-weight: 600; cursor: pointer; transition: all 0.2s;
    }
    .view-toggle button.active {
      background: linear-gradient(135deg, #06b6d4, #8b5cf6);
      color: #fff;
    }

    .filter-reset {
      background: none; border: none; color: #06b6d4;
      font-size: 12px; cursor: pointer; font-family: inherit; padding: 8px 4px;
    }
    .filter-reset:hover { text-decoration: underline; }

    /* Charts */
    .charts-row {
      display: grid; grid-template-columns: 1fr 320px; gap: 16px;
      margin-bottom: 24px;
    }
    .chart-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px; padding: 20px;
    }
    .chart-title { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
    .chart-subtitle { font-size: 12px; color: #64748b; margin-bottom: 16px; }

    /* Task List */
    .task-list-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px; overflow: hidden;
      margin-bottom: 24px;
    }
    .task-list-header {
      padding: 16px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      display: flex; justify-content: space-between; align-items: center;
    }
    .task-list-title { font-size: 15px; font-weight: 600; }
    .task-count { font-size: 12px; color: #64748b; }
    .task-list { max-height: 500px; overflow-y: auto; }
    .task-list::-webkit-scrollbar { width: 6px; }
    .task-list::-webkit-scrollbar-track { background: transparent; }
    .task-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

    .task-item {
      padding: 12px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      transition: background 0.15s;
    }
    .task-item:hover { background: rgba(255,255,255,0.03); }
    .task-item:last-child { border-bottom: none; }
    .task-top { display: flex; align-items: flex-start; gap: 10px; }
    .task-status-icon {
      width: 22px; height: 22px; border-radius: 50%; flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      font-size: 11px; font-weight: 700; margin-top: 1px;
    }
    .task-status-icon.complete { background: rgba(16,185,129,0.15); color: #10b981; }
    .task-status-icon.overdue { background: rgba(239,68,68,0.15); color: #ef4444; }
    .task-status-icon.active { background: rgba(6,182,212,0.15); color: #06b6d4; }
    .task-name { font-size: 13px; font-weight: 500; }
    .task-meta {
      display: flex; gap: 12px; margin-top: 4px; margin-left: 32px;
      font-size: 11px; color: #64748b; flex-wrap: wrap;
    }
    .task-meta span { display: flex; align-items: center; gap: 3px; }

    .no-data { text-align: center; padding: 40px; color: #475569; font-size: 14px; }

    /* Loading */
    .loading-state {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 80px 20px; gap: 16px;
    }
    .spinner {
      width: 36px; height: 36px; border-radius: 50%;
      border: 3px solid rgba(255,255,255,0.1);
      border-top-color: #06b6d4;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-text { color: #64748b; font-size: 14px; }

    .error-banner {
      background: rgba(239,68,68,0.1);
      border: 1px solid rgba(239,68,68,0.25);
      border-radius: 10px; padding: 14px 20px;
      margin-bottom: 20px; color: #f87171; font-size: 13px;
    }

    .footer {
      text-align: center; padding: 20px; font-size: 12px; color: #475569;
    }
    .footer span { color: #06b6d4; }

    @media (max-width: 768px) {
      .dashboard { padding: 12px; }
      .charts-row { grid-template-columns: 1fr; }
      .filters { flex-direction: column; align-items: stretch; }
      select, input[type="date"] { min-width: 100%; }
      .view-toggle { margin-left: 0; }
      .stats-row { grid-template-columns: repeat(3, 1fr); }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/prop-types@15/prop-types.min.js"></script>
  <script crossorigin src="https://unpkg.com/recharts@2.1.16/umd/Recharts.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;
    const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell, PieChart, Pie } = Recharts;

    const API_BASE = '/api/teamwork';
    const COLORS = ['#06b6d4', '#8b5cf6', '#f59e0b', '#10b981', '#ef4444', '#ec4899', '#6366f1', '#14b8a6', '#84cc16', '#f97316'];

    function api(endpoint, params = {}) {
      const query = new URLSearchParams({ endpoint, ...params });
      return fetch(`${API_BASE}?${query}`).then(r => {
        if (!r.ok) throw new Error(`API ${r.status}`);
        return r.json();
      });
    }

    function parseDate(str) {
      if (!str) return null;
      const clean = str.replace(/-/g, '');
      if (clean.length === 8) {
        return new Date(clean.slice(0,4), parseInt(clean.slice(4,6))-1, clean.slice(6,8));
      }
      return new Date(str);
    }

    function formatDate(d) {
      if (!d) return '';
      return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    function TeamworkDashboard() {
      const [projects, setProjects] = useState([]);
      const [people, setPeople] = useState([]);
      const [tasks, setTasks] = useState([]);
      const [timeEntries, setTimeEntries] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [lastUpdated, setLastUpdated] = useState(null);

      // Filters
      const [viewMode, setViewMode] = useState('staff');
      const [selectedProject, setSelectedProject] = useState('all');
      const [selectedStaff, setSelectedStaff] = useState('all');
      const [dateRange, setDateRange] = useState({ start: '', end: '' });

      const fetchData = useCallback(async () => {
        setLoading(true);
        setError(null);
        try {
          const [projRes, peopleRes, tasksRes, timeRes] = await Promise.all([
            api('projects.json', { status: 'active' }),
            api('people.json', { pageSize: '250' }),
            api('tasks.json', { pageSize: '250', includeCompletedTasks: 'true' }),
            api('time_entries.json', { pageSize: '250' }),
          ]);

          setProjects(projRes.projects || []);
          setPeople(peopleRes.people || []);
          setTasks(tasksRes['todo-items'] || []);
          setTimeEntries(timeRes['time-entries'] || []);
          setLastUpdated(new Date());
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      }, []);

      useEffect(() => { fetchData(); }, [fetchData]);

      // Active Staff (with tasks or hours)
      const activeStaff = useMemo(() => {
        return people.filter(p =>
          tasks.some(t => (t['responsible-party-ids'] || '').split(',').includes(String(p.id))) ||
          timeEntries.some(te => String(te['person-id']) === String(p.id))
        );
      }, [people, tasks, timeEntries]);

      // Filtered Tasks
      const filteredTasks = useMemo(() => {
        return tasks.filter(task => {
          if (selectedProject !== 'all' && String(task['project-id']) !== selectedProject) return false;
          if (selectedStaff !== 'all') {
            const ids = (task['responsible-party-ids'] || '').split(',');
            if (!ids.includes(selectedStaff)) return false;
          }
          if (dateRange.start || dateRange.end) {
            const d = parseDate(task['due-date']);
            if (!d) return false;
            if (dateRange.start && d < new Date(dateRange.start)) return false;
            if (dateRange.end && d > new Date(dateRange.end + 'T23:59:59')) return false;
          }
          return true;
        });
      }, [tasks, selectedProject, selectedStaff, dateRange]);

      // Filtered Time Entries
      const filteredTimeEntries = useMemo(() => {
        return timeEntries.filter(entry => {
          if (selectedProject !== 'all' && String(entry['project-id']) !== selectedProject) return false;
          if (selectedStaff !== 'all' && String(entry['person-id']) !== selectedStaff) return false;
          if (dateRange.start && entry.date && new Date(entry.date) < new Date(dateRange.start)) return false;
          if (dateRange.end && entry.date && new Date(entry.date) > new Date(dateRange.end + 'T23:59:59')) return false;
          return true;
        });
      }, [timeEntries, selectedProject, selectedStaff, dateRange]);

      // Stats
      const stats = useMemo(() => {
        const total = filteredTasks.length;
        const completed = filteredTasks.filter(t => t.completed).length;
        const overdue = filteredTasks.filter(t => {
          if (t.completed) return false;
          const d = parseDate(t['due-date']);
          return d && d < new Date();
        }).length;
        const active = total - completed - overdue;
        const totalHours = filteredTimeEntries.reduce((sum, e) => sum + (parseFloat(e.hoursDecimal) || 0), 0);
        return { total, completed, active, overdue, totalHours };
      }, [filteredTasks, filteredTimeEntries]);

      // Workload Chart Data
      const workloadData = useMemo(() => {
        if (viewMode === 'staff') {
          const map = {};
          activeStaff.forEach(p => {
            map[p.id] = {
              name: p['first-name'] || 'Unknown',
              fullName: (p['first-name'] || '') + ' ' + (p['last-name'] || ''),
              tasks: 0, hours: 0,
            };
          });
          filteredTasks.forEach(task => {
            (task['responsible-party-ids'] || '').split(',').forEach(id => {
              if (map[id]) map[id].tasks++;
            });
          });
          filteredTimeEntries.forEach(entry => {
            const pid = String(entry['person-id']);
            if (map[pid]) map[pid].hours += parseFloat(entry.hoursDecimal) || 0;
          });
          return Object.values(map)
            .filter(d => d.tasks > 0 || d.hours > 0)
            .sort((a, b) => b.hours - a.hours)
            .map(d => ({ ...d, hours: Math.round(d.hours * 10) / 10 }));
        } else {
          const map = {};
          projects.forEach(p => {
            map[p.id] = {
              name: (p.name || '').length > 25 ? p.name.slice(0, 22) + '‚Ä¶' : (p.name || 'Unknown'),
              fullName: p.name || 'Unknown',
              tasks: 0, hours: 0,
            };
          });
          filteredTasks.forEach(task => {
            const pid = String(task['project-id']);
            if (map[pid]) map[pid].tasks++;
          });
          filteredTimeEntries.forEach(entry => {
            const pid = String(entry['project-id']);
            if (map[pid]) map[pid].hours += parseFloat(entry.hoursDecimal) || 0;
          });
          return Object.values(map)
            .filter(d => d.tasks > 0 || d.hours > 0)
            .sort((a, b) => b.hours - a.hours)
            .map(d => ({ ...d, hours: Math.round(d.hours * 10) / 10 }));
        }
      }, [viewMode, activeStaff, projects, filteredTasks, filteredTimeEntries]);

      // Pie Data
      const pieData = useMemo(() => {
        return [
          { name: 'Active', value: stats.active, fill: '#06b6d4' },
          { name: 'Completed', value: stats.completed, fill: '#10b981' },
          { name: 'Overdue', value: stats.overdue, fill: '#ef4444' },
        ].filter(d => d.value > 0);
      }, [stats]);

      const getTaskStatus = (task) => {
        if (task.completed) return 'complete';
        const d = parseDate(task['due-date']);
        if (d && d < new Date()) return 'overdue';
        return 'active';
      };

      const sortedTasks = useMemo(() => {
        return [...filteredTasks].sort((a, b) => {
          const sa = getTaskStatus(a) === 'overdue' ? 0 : getTaskStatus(a) === 'active' ? 1 : 2;
          const sb = getTaskStatus(b) === 'overdue' ? 0 : getTaskStatus(b) === 'active' ? 1 : 2;
          if (sa !== sb) return sa - sb;
          const da = parseDate(a['due-date']);
          const db = parseDate(b['due-date']);
          if (!da && !db) return 0;
          if (!da) return 1;
          if (!db) return -1;
          return da - db;
        });
      }, [filteredTasks]);

      const hasFilters = selectedProject !== 'all' || selectedStaff !== 'all' || dateRange.start || dateRange.end;

      const resetFilters = () => {
        setSelectedProject('all');
        setSelectedStaff('all');
        setDateRange({ start: '', end: '' });
      };

      // Custom Tooltip
      const CustomTooltip = ({ active, payload }) => {
        if (!active || !payload?.length) return null;
        const data = payload[0]?.payload;
        return (
          <div style={{
            background: '#1e293b', border: '1px solid rgba(255,255,255,0.1)',
            borderRadius: 8, padding: '10px 14px', fontSize: 13,
            boxShadow: '0 8px 24px rgba(0,0,0,0.4)',
          }}>
            <div style={{ fontWeight: 600, marginBottom: 6 }}>{data?.fullName || data?.name}</div>
            {payload.map((p, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: 6, marginTop: 3 }}>
                <span style={{ width: 8, height: 8, borderRadius: '50%', background: p.color || p.fill, display: 'inline-block' }} />
                <span style={{ color: '#94a3b8' }}>{p.name}:</span>
                <span style={{ fontWeight: 600 }}>{p.dataKey === 'hours' ? p.value + 'h' : p.value}</span>
              </div>
            ))}
          </div>
        );
      };

      return (
        <div className="dashboard">
          {/* Header */}
          <div className="header">
            <div>
              <h1>‚òÅ 9Cloud Teamwork Dashboard</h1>
              <div className="header-sub">Real-time project tracking & workload overview</div>
            </div>
            <div className="header-actions">
              {lastUpdated && <span className="last-updated">Updated {lastUpdated.toLocaleTimeString()}</span>}
              <button className="btn btn-primary" onClick={fetchData} disabled={loading}>
                {loading ? '‚ü≥ Loading‚Ä¶' : '‚Üª Refresh'}
              </button>
            </div>
          </div>

          {error && (
            <div className="error-banner">
              ‚ö† Failed to load data: {error}. Check your API configuration and try refreshing.
            </div>
          )}

          {loading ? (
            <div className="loading-state">
              <div className="spinner" />
              <div className="loading-text">Connecting to Teamwork‚Ä¶</div>
            </div>
          ) : (
            <>
              {/* Stats */}
              <div className="stats-row">
                <div className="stat-card">
                  <div className="stat-value">{stats.total}</div>
                  <div className="stat-label">Total Tasks</div>
                </div>
                <div className="stat-card">
                  <div className="stat-value green">{stats.completed}</div>
                  <div className="stat-label">Completed</div>
                </div>
                <div className="stat-card">
                  <div className="stat-value amber">{stats.active}</div>
                  <div className="stat-label">In Progress</div>
                </div>
                <div className="stat-card">
                  <div className="stat-value red">{stats.overdue}</div>
                  <div className="stat-label">Overdue</div>
                </div>
                <div className="stat-card">
                  <div className="stat-value purple">{stats.totalHours.toFixed(1)}h</div>
                  <div className="stat-label">Hours Logged</div>
                </div>
              </div>

              {/* Filters */}
              <div className="filters">
                <div className="filter-group">
                  <label className="filter-label">Project</label>
                  <select value={selectedProject} onChange={e => setSelectedProject(e.target.value)}>
                    <option value="all">All Projects</option>
                    {projects.sort((a, b) => (a.name || '').localeCompare(b.name || '')).map(p => (
                      <option key={p.id} value={String(p.id)}>{p.name}</option>
                    ))}
                  </select>
                </div>
                <div className="filter-group">
                  <label className="filter-label">Staff</label>
                  <select value={selectedStaff} onChange={e => setSelectedStaff(e.target.value)}>
                    <option value="all">All Staff</option>
                    {people.sort((a, b) => (a['first-name'] || '').localeCompare(b['first-name'] || '')).map(p => (
                      <option key={p.id} value={String(p.id)}>
                        {p['first-name']} {p['last-name'] || ''}
                      </option>
                    ))}
                  </select>
                </div>
                <div className="filter-group">
                  <label className="filter-label">Due Date (From)</label>
                  <input type="date" value={dateRange.start}
                    onChange={e => setDateRange(prev => ({ ...prev, start: e.target.value }))} />
                </div>
                <div className="filter-group">
                  <label className="filter-label">Due Date (To)</label>
                  <input type="date" value={dateRange.end}
                    onChange={e => setDateRange(prev => ({ ...prev, end: e.target.value }))} />
                </div>
                {hasFilters && <button className="filter-reset" onClick={resetFilters}>‚úï Clear filters</button>}

                <div className="view-toggle">
                  <button className={viewMode === 'staff' ? 'active' : ''} onClick={() => setViewMode('staff')}>
                    üë§ By Staff
                  </button>
                  <button className={viewMode === 'project' ? 'active' : ''} onClick={() => setViewMode('project')}>
                    üìÅ By Project
                  </button>
                </div>
              </div>

              {/* Task List */}
              <div className="task-list-card">
                <div className="task-list-header">
                  <span className="task-list-title">Tasks</span>
                  <span className="task-count">{filteredTasks.length} tasks</span>
                </div>
                <div className="task-list">
                  {sortedTasks.length > 0 ? sortedTasks.map(task => {
                    const status = getTaskStatus(task);
                    const dueDate = parseDate(task['due-date']);
                    return (
                      <div key={task.id} className="task-item">
                        <div className="task-top">
                          <span className={`task-status-icon ${status}`}>
                            {status === 'complete' ? '‚úì' : status === 'overdue' ? '!' : '‚óã'}
                          </span>
                          <span className="task-name">{task.content}</span>
                        </div>
                        <div className="task-meta">
                          <span>üìÅ {task['project-name']}</span>
                          {task['responsible-party-summary'] && (
                            <span>üë§ {task['responsible-party-summary']}</span>
                          )}
                          {dueDate && (
                            <span style={{ color: status === 'overdue' ? '#ef4444' : '#64748b' }}>
                              üìÖ {formatDate(dueDate)}
                            </span>
                          )}
                        </div>
                      </div>
                    );
                  }) : (
                    <div className="no-data">No tasks match your filters</div>
                  )}
                </div>
              </div>

              {/* Charts */}
              <div className="charts-row">
                <div className="chart-card">
                  <div className="chart-title">
                    {viewMode === 'staff' ? 'Workload by Staff' : 'Workload by Project'}
                  </div>
                  <div className="chart-subtitle">Tasks & hours logged</div>
                  {workloadData.length > 0 ? (
                    <ResponsiveContainer width="100%" height={Math.max(280, workloadData.length * 44)}>
                      <BarChart data={workloadData} layout="vertical" margin={{ left: 10, right: 20, top: 5, bottom: 5 }}>
                        <XAxis type="number" tick={{ fill: '#64748b', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <YAxis type="category" dataKey="name" width={120}
                          tick={{ fill: '#94a3b8', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <Tooltip content={<CustomTooltip />} cursor={{ fill: 'rgba(6,182,212,0.06)' }} />
                        <Bar dataKey="hours" name="Hours" fill="#8b5cf6" radius={[0, 4, 4, 0]} barSize={16} />
                        <Bar dataKey="tasks" name="Tasks" fill="#06b6d4" radius={[0, 4, 4, 0]} barSize={16} />
                      </BarChart>
                    </ResponsiveContainer>
                  ) : (
                    <div className="no-data">No data to display</div>
                  )}
                </div>

                <div className="chart-card">
                  <div className="chart-title">Task Status</div>
                  <div className="chart-subtitle">Overall breakdown</div>
                  {pieData.length > 0 ? (
                    <>
                      <ResponsiveContainer width="100%" height={220}>
                        <PieChart>
                          <Pie data={pieData} cx="50%" cy="50%" innerRadius={55} outerRadius={85}
                            paddingAngle={3} dataKey="value">
                            {pieData.map((entry, i) => (
                              <Cell key={i} fill={entry.fill} />
                            ))}
                          </Pie>
                          <Tooltip content={<CustomTooltip />} />
                        </PieChart>
                      </ResponsiveContainer>
                      <div style={{ display: 'flex', justifyContent: 'center', gap: 16, marginTop: 4 }}>
                        {pieData.map(d => (
                          <div key={d.name} style={{ display: 'flex', alignItems: 'center', gap: 6, fontSize: 12 }}>
                            <span style={{ width: 8, height: 8, borderRadius: '50%', background: d.fill, display: 'inline-block' }} />
                            <span style={{ color: '#94a3b8' }}>{d.name}</span>
                            <span style={{ fontWeight: 600 }}>{d.value}</span>
                          </div>
                        ))}
                      </div>
                    </>
                  ) : (
                    <div className="no-data">No data to display</div>
                  )}
                </div>
              </div>

              <div className="footer">
                Connected to <span>9cloudwebworks.teamwork.com</span>
                {lastUpdated && <> ‚Ä¢ Data synced {lastUpdated.toLocaleString()}</>}
              </div>
            </>
          )}
        </div>
      );
    }

    ReactDOM.render(<TeamworkDashboard />, document.getElementById('root'));
  </script>
</body>
</html>
